
/* cytoscape.layout.arbor.min.js */

/**
 * This file is part of cytoscape.js 2.0.2.
 * 
 * Cytoscape.js is free software: you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the Free
 * Software Foundation, either version 3 of the License, or (at your option) any
 * later version.
 * 
 * Cytoscape.js is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
 * details.
 * 
 * You should have received a copy of the GNU Lesser General Public License along with
 * cytoscape.js. If not, see <http://www.gnu.org/licenses/>.
 */
 
(function(a){var b={liveUpdate:true,ready:undefined,stop:undefined,maxSimulationTime:4000,fit:true,padding:[50,50,50,50],ungrabifyWhileSimulating:true,repulsion:undefined,stiffness:undefined,friction:undefined,gravity:true,fps:undefined,precision:undefined,nodeMass:undefined,edgeLength:undefined,stepSize:1,stableEnergy:function(d){var f=d;return(f.max<=0.5)||(f.mean<=0.3)}};function c(d){this.options=a.util.extend({},b,d)}c.prototype.run=function(){var k=this.options;var j=k.cy;var u=j.nodes();var i=j.edges();
var p=j.container();var t=p.clientWidth;var r=p.clientHeight;if(j.nodes().size()<=1){if(k.fit){j.reset()}j.nodes().position({x:Math.round(t/2),y:Math.round(r/2)});j.one("layoutstop",k.stop);j.trigger("layoutstop");j.one("layoutstop",k.stop);j.trigger("layoutstop");return}var m=this.system=arbor.ParticleSystem(k.repulsion,k.stiffness,k.friction,k.gravity,k.fps,k.dt,k.precision);this.system=m;if(k.liveUpdate&&k.fit){j.reset()}var s=250;var g;var o=false;var f=+new Date;var q={init:function(w){},redraw:function(){var x=m.energy();
if(k.stableEnergy!=null&&x!=null&&x.n>0&&k.stableEnergy(x)){m.stop();return}clearTimeout(g);g=setTimeout(v,s);var y=[];m.eachNode(function(E,z){var D=E.name;var B=E.data;var A=B.element;if(A==null){return}var C=A._private.position;if(!A.locked()&&!A.grabbed()){C.x=z.x;C.y=z.y;y.push(A)}});var w=(+new Date-f)>=16;if(k.liveUpdate&&y.length>0&&w){new a.Collection(j,y).rtrigger("position");f=+new Date}if(!o){o=true;j.one("layoutready",k.ready);j.trigger("layoutready")}}};m.renderer=q;m.screenSize(t,r);
m.screenPadding(k.padding[0],k.padding[1],k.padding[2],k.padding[3]);m.screenStep(k.stepSize);function n(w,x){if(x==null){return undefined}else{if(typeof x==typeof function(){}){return x.apply(w,[w._private.data,{nodes:u.length,edges:i.length,element:w}])}else{return x}}}function d(D){var G=D.x;var E=D.y;var H=t;var B=r;var A=-2;var I=2;var F=-2;var z=2;var C=4;return{x:G/H*C+A,y:E/B*C+I}}var l=function(x){grabbed=this;var y=m.fromScreen(this.position());var w=arbor.Point(y.x,y.y);this.scratch().arbor.p=w;
switch(x.type){case"grab":this.scratch().arbor.fixed=true;break;case"dragstop":this.scratch().arbor.fixed=false;this.scratch().arbor.tempMass=1000;break}};u.bind("grab drag dragstop",l);u.each(function(y,z){var B=this._private.data.id;var x=n(this,k.nodeMass);var w=this._private.locked;var A=d({x:z.position().x,y:z.position().y});if(z.locked()){return}this.scratch().arbor=m.addNode(B,{element:this,mass:x,fixed:w,x:w?A.x:undefined,y:w?A.y:undefined})});i.each(function(){var z=this.id();var x=this.source().id();
var y=this.target().id();var w=n(this,k.edgeLength);this.scratch().arbor=m.addEdge(x,y,{length:w})});function h(w){if(k.fit){j.fit()}w()}var e=u.filter(":grabbable");if(k.ungrabifyWhileSimulating){e.ungrabify()}var v=function(){if(window.isIE){h(function(){w()})}else{w()}function w(){if(!k.liveUpdate){if(k.fit){j.reset()}j.nodes().rtrigger("position")}u.unbind("grab drag dragstop",l);if(k.ungrabifyWhileSimulating){e.grabify()}j.one("layoutstop",k.stop);j.trigger("layoutstop")}};m.start();setTimeout(function(){m.stop()
},k.maxSimulationTime)};c.prototype.stop=function(){if(this.system!=null){system.stop()}};a("layout","arbor",c)})(cytoscape);